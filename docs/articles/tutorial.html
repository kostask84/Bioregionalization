<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial for Bioregionalization R package • Bioregionalization</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial for Bioregionalization R package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bioregionalization</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Tutorial for Bioregionalization R package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial for Bioregionalization R package</h1>
                        <h4 class="author">Pierre Denelle</h4>
            
            <h4 class="date">2019-10-31</h4>
      
      
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<p>The principle of the package is illustrated by the following figure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/Bioregionalization_scheme2.png"</span>)</a></code></pre></div>
<p><img src="../figures/Bioregionalization_scheme2.png" width="1228"></p>
<p><code>virtual_sp</code> is a dataset simulated that comes with the package. This dataset relies on the response curve of virtual species to a virtual raster. The virtual raster contains 10000 cells and was simulated using <code>gstat</code> R package. <a href="http://santiago.begueria.es/2010/10/generating-spatially-correlated-random-fields-with-r/">See here for details.</a></p>
<p>Based on this layer, the <code>virtualspecies</code> R package (Leroy et al. 2015) was used to simulate the response curve of 100 virtual species. A Gaussian curve was used. The mean and standard deviation of the response function was varying among species, such as some of them are more or less generalists/specialists.</p>
<p>For every species in every cell, we could derive a suitability index. Species with suitability index inferior to 0.15 were arbitrarily set absent.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Import virtual dataset</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"virtual_sp"</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># Only species data.frame</span></a>
<a class="sourceLine" id="cb2-5" title="5">sp_df &lt;-<span class="st"> </span>virtual[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co"># Plot of environmental values</span></a>
<a class="sourceLine" id="cb2-8" title="8">sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="st">  </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> env, <span class="dt">color =</span> env),</a>
<a class="sourceLine" id="cb2-12" title="12">            <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="st">  </span><span class="kw">scale_color_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="st">  </span><span class="kw">scale_fill_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Environmental variable"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,<span class="dt">colour =</span> <span class="ot">NA</span>))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/dataset-1.png" width="1152"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/sp1_response_curve.png"</span>)</a></code></pre></div>
<p><img src="../figures/sp1_response_curve.png" width="362"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/sp1_suitability.png"</span>)</a></code></pre></div>
<p><img src="../figures/sp1_suitability.png" width="362"></p>
<p>The first step is to convert the data.frame into a contingency table.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">sp_mat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/contingency.html">contingency</a></span>(sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), ],</a>
<a class="sourceLine" id="cb5-2" title="2">                      <span class="st">"site"</span>, <span class="st">"sp"</span>, <span class="dt">ab =</span> <span class="ot">NULL</span>, <span class="dt">binary =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-3" title="3">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(sp_mat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">sp1</th>
<th align="right">sp2</th>
<th align="right">sp3</th>
<th align="right">sp4</th>
<th align="right">sp5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>site1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>site10</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>site100</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>site101</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>site102</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># With weights</span></a>
<a class="sourceLine" id="cb6-2" title="2">sp_mat_w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/contingency.html">contingency</a></span>(sp_df, <span class="st">"site"</span>, <span class="st">"sp"</span>, <span class="dt">ab =</span> <span class="st">"suitab"</span>, <span class="dt">binary =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>We then need to project the network.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">sp_proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_network.html">project_network</a></span>(sp_mat, <span class="dt">similarity =</span> <span class="st">"simpson"</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">sp_proj &lt;-<span class="st"> </span>sp_proj[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>, <span class="st">"simpson"</span>)]</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sp_proj))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id1</th>
<th align="right">id2</th>
<th align="right">simpson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">8</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">9</td>
<td align="right">0.8571429</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10</td>
<td align="right">0.6666667</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">11</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">sp_proj_w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_network.html">project_network</a></span>(sp_mat_w, <span class="dt">similarity =</span> <span class="st">"bray"</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">sp_proj_w &lt;-<span class="st"> </span>sp_proj_w[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>, <span class="st">"bray"</span>)]</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sp_proj_w))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">id1</th>
<th align="right">id2</th>
<th align="right">bray</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0.0162964</td>
</tr>
<tr class="even">
<td>3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td>4</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">0.0005101</td>
</tr>
<tr class="even">
<td>5</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.0000020</td>
</tr>
<tr class="odd">
<td>6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.0002640</td>
</tr>
<tr class="even">
<td>7</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.0016733</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/Lenormand_et_al_2019_Figure2.png"</span>)</a></code></pre></div>
<p><img src="../figures/Lenormand_et_al_2019_Figure2.png" width="551"></p>
<p>Running OSLOM. tp files containing the modularity results are directly stored within the virtual dataset, but the following chunk can be run independently.</p>
<p>Output of OSLOM are stored in a chosen directory and can be import into R with the command <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">run_oslom</span>(sp_proj, <span class="dt">n_runs =</span> <span class="dv">5</span>, <span class="dt">t_param =</span> <span class="fl">0.1</span>, <span class="dt">cp_param =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb10-2" title="2">          <span class="dt">saving_directory =</span> <span class="st">"D:/PIERRE_DENELLE/CarHab/Bioregionalization_extra/"</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4">res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"../../Bioregionalization_extra/tp.rds"</span>)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.rename</a></span>(<span class="st">"../../Bioregionalization_extra/tp.rds"</span>,</a>
<a class="sourceLine" id="cb10-6" title="6">            <span class="st">"../../Bioregionalization_extra/tp_binary.rds"</span>)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co"># With weights</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="kw">run_oslom</span>(sp_proj_w, <span class="dt">n_runs =</span> <span class="dv">5</span>, <span class="dt">t_param =</span> <span class="fl">0.1</span>, <span class="dt">cp_param =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb10-9" title="9">          <span class="dt">saving_directory =</span> <span class="st">"../../Bioregionalization_extra/"</span>)</a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11">res_w &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"../../Bioregionalization_extra/tp.rds"</span>)</a></code></pre></div>
<p>Converting the OSLOM .tp file into a list.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># Format OSLOM output into a data.frame</span></a>
<a class="sourceLine" id="cb11-2" title="2">oslom_vignette &lt;-<span class="st"> </span><span class="kw"><a href="../reference/oslom_output.html">oslom_output</a></span>(virtual[[<span class="dv">2</span>]], sp_mat)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># With weights</span></a>
<a class="sourceLine" id="cb11-4" title="4">oslom_vignette_w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/oslom_output.html">oslom_output</a></span>(virtual[[<span class="dv">3</span>]], sp_mat_w)</a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Number of bioregions detected = "</span>,</a>
<a class="sourceLine" id="cb11-7" title="7">             <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(oslom_vignette<span class="op">$</span>bioregion)),</a>
<a class="sourceLine" id="cb11-8" title="8">             <span class="st">"; and with weights: "</span>,</a>
<a class="sourceLine" id="cb11-9" title="9">             <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(oslom_vignette_w<span class="op">$</span>bioregion))))</a></code></pre></div>
<pre><code>## [1] "Number of bioregions detected = 9; and with weights: 6"</code></pre>
<p>Step 3 of Figure 1 (see Lenormand et al. (2019))</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/zscore_scheme.png"</span>)</a></code></pre></div>
<p><img src="../figures/zscore_scheme.png" width="514"></p>
<p><span class="math display">\[
\rho_{ij} = \frac{n_{ij} - \frac{n_in_j}{n}}{\sqrt(\frac{n-n_j}{n-1}(1-\frac{n_j}{n})\frac{n_jn_i}{n})}
\]</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># tmp &lt;- left_join(sp_df, oslom_vignette, by = "site")</span></a>
<a class="sourceLine" id="cb14-2" title="2">tmp &lt;-<span class="st"> </span><span class="kw">left_join</span>(sp_df, oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">z_scores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zscore.html">zscore</a></span>(tmp, <span class="dt">sp_col =</span> <span class="st">"sp"</span>, <span class="dt">site_col =</span> <span class="st">"site"</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">                   <span class="dt">bioregion_col =</span> <span class="st">"bioregion"</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb14-5" title="5">                   <span class="dt">output_format =</span> <span class="st">"dataframe"</span>)</a>
<a class="sourceLine" id="cb14-6" title="6"></a>
<a class="sourceLine" id="cb14-7" title="7">top10 &lt;-<span class="st"> </span>z_scores[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(bioregion) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="st">  </span><span class="kw">top_n</span>(<span class="dt">n =</span> <span class="dv">10</span>, zscore) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># extract top 10</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank =</span> <span class="kw"><a href="https://rdrr.io/r/base/rank.html">rank</a></span>(<span class="op">-</span>zscore, <span class="co"># ranking zcore in an ascending order</span></a>
<a class="sourceLine" id="cb14-11" title="11">                     <span class="dt">ties.method =</span> <span class="st">"first"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># if tie zscore, first species</span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(sp, bioregion, zscore, rank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">zscore =</span> <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(zscore, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># rounding zscore to 1 digit</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>()</a>
<a class="sourceLine" id="cb14-15" title="15"></a>
<a class="sourceLine" id="cb14-16" title="16">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(top10[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(top10<span class="op">$</span>bioregion <span class="op">==</span><span class="st"> "2"</span>), ])</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">sp</th>
<th align="left">bioregion</th>
<th align="right">zscore</th>
<th align="right">rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>101</td>
<td align="left">sp1</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>102</td>
<td align="left">sp2</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>103</td>
<td align="left">sp3</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>104</td>
<td align="left">sp4</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>105</td>
<td align="left">sp5</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td>106</td>
<td align="left">sp6</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td>107</td>
<td align="left">sp7</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td>108</td>
<td align="left">sp8</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td>109</td>
<td align="left">sp9</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td>110</td>
<td align="left">sp10</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td>111</td>
<td align="left">sp11</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td>112</td>
<td align="left">sp12</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td>113</td>
<td align="left">sp13</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td>114</td>
<td align="left">sp14</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td>115</td>
<td align="left">sp15</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td>116</td>
<td align="left">sp16</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td>117</td>
<td align="left">sp17</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td>118</td>
<td align="left">sp18</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td>119</td>
<td align="left">sp19</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td>120</td>
<td align="left">sp20</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td>121</td>
<td align="left">sp21</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td>122</td>
<td align="left">sp22</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td>123</td>
<td align="left">sp23</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td>124</td>
<td align="left">sp24</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td>125</td>
<td align="left">sp25</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td>126</td>
<td align="left">sp26</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td>127</td>
<td align="left">sp27</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td>128</td>
<td align="left">sp28</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td>129</td>
<td align="left">sp29</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td>130</td>
<td align="left">sp30</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">30</td>
</tr>
<tr class="odd">
<td>131</td>
<td align="left">sp31</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td>132</td>
<td align="left">sp32</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">32</td>
</tr>
<tr class="odd">
<td>133</td>
<td align="left">sp33</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td>134</td>
<td align="left">sp34</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">34</td>
</tr>
<tr class="odd">
<td>135</td>
<td align="left">sp35</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td>136</td>
<td align="left">sp36</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td>137</td>
<td align="left">sp37</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td>138</td>
<td align="left">sp38</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td>139</td>
<td align="left">sp39</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td>140</td>
<td align="left">sp40</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td>141</td>
<td align="left">sp41</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td>142</td>
<td align="left">sp42</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td>143</td>
<td align="left">sp43</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">43</td>
</tr>
<tr class="even">
<td>144</td>
<td align="left">sp44</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td>145</td>
<td align="left">sp45</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td>146</td>
<td align="left">sp46</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td>147</td>
<td align="left">sp47</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">47</td>
</tr>
<tr class="even">
<td>148</td>
<td align="left">sp48</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td>149</td>
<td align="left">sp49</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td>150</td>
<td align="left">sp50</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td>151</td>
<td align="left">sp51</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td>152</td>
<td align="left">sp52</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td>153</td>
<td align="left">sp53</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">53</td>
</tr>
<tr class="even">
<td>154</td>
<td align="left">sp54</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">54</td>
</tr>
<tr class="odd">
<td>155</td>
<td align="left">sp55</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">55</td>
</tr>
<tr class="even">
<td>156</td>
<td align="left">sp56</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td>157</td>
<td align="left">sp57</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td>158</td>
<td align="left">sp58</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td>159</td>
<td align="left">sp59</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td>160</td>
<td align="left">sp60</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td>161</td>
<td align="left">sp61</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td>162</td>
<td align="left">sp62</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td>163</td>
<td align="left">sp63</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td>164</td>
<td align="left">sp64</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td>165</td>
<td align="left">sp65</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">65</td>
</tr>
<tr class="even">
<td>166</td>
<td align="left">sp66</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">66</td>
</tr>
<tr class="odd">
<td>167</td>
<td align="left">sp67</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td>168</td>
<td align="left">sp68</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td>169</td>
<td align="left">sp69</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td>170</td>
<td align="left">sp70</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td>171</td>
<td align="left">sp71</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td>172</td>
<td align="left">sp72</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">72</td>
</tr>
<tr class="odd">
<td>173</td>
<td align="left">sp73</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">73</td>
</tr>
<tr class="even">
<td>174</td>
<td align="left">sp74</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">74</td>
</tr>
<tr class="odd">
<td>175</td>
<td align="left">sp75</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td>176</td>
<td align="left">sp76</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">76</td>
</tr>
<tr class="odd">
<td>177</td>
<td align="left">sp77</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">77</td>
</tr>
<tr class="even">
<td>178</td>
<td align="left">sp78</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td>179</td>
<td align="left">sp79</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">79</td>
</tr>
<tr class="even">
<td>180</td>
<td align="left">sp80</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td>181</td>
<td align="left">sp81</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td>182</td>
<td align="left">sp82</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td>183</td>
<td align="left">sp83</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">83</td>
</tr>
<tr class="even">
<td>184</td>
<td align="left">sp84</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">84</td>
</tr>
<tr class="odd">
<td>185</td>
<td align="left">sp85</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">85</td>
</tr>
<tr class="even">
<td>186</td>
<td align="left">sp86</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">86</td>
</tr>
<tr class="odd">
<td>187</td>
<td align="left">sp87</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">87</td>
</tr>
<tr class="even">
<td>188</td>
<td align="left">sp88</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">88</td>
</tr>
<tr class="odd">
<td>189</td>
<td align="left">sp89</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td>190</td>
<td align="left">sp90</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td>191</td>
<td align="left">sp91</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">91</td>
</tr>
<tr class="even">
<td>192</td>
<td align="left">sp92</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td>193</td>
<td align="left">sp93</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">93</td>
</tr>
<tr class="even">
<td>194</td>
<td align="left">sp94</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">94</td>
</tr>
<tr class="odd">
<td>195</td>
<td align="left">sp95</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">95</td>
</tr>
<tr class="even">
<td>196</td>
<td align="left">sp96</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">96</td>
</tr>
<tr class="odd">
<td>197</td>
<td align="left">sp97</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">97</td>
</tr>
<tr class="even">
<td>198</td>
<td align="left">sp98</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">98</td>
</tr>
<tr class="odd">
<td>199</td>
<td align="left">sp99</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">99</td>
</tr>
<tr class="even">
<td>200</td>
<td align="left">sp100</td>
<td align="left">2</td>
<td align="right">0</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
<p>Interaction plots.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(z_scores[[<span class="dv">2</span>]]))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">focal_bioregion</th>
<th align="left">bioregion</th>
<th align="right">lambda</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">1</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1</td>
<td align="right">NaN</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">1</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">1</td>
<td align="right">NaN</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">1</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">1</td>
<td align="right">NaN</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">z_scores[[<span class="dv">3</span>]]</a></code></pre></div>
<p><img src="tutorial_files/figure-html/lambda-1.png" width="1152"></p>
<p>Example with Ward analysis and k-means clustering.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># CA_res &lt;- CA_cluster(sp_mat)</span></a>
<a class="sourceLine" id="cb17-2" title="2">ward_res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ward_cluster.html">ward_cluster</a></span>(sp_mat, <span class="dt">K.max =</span> <span class="dv">6</span>)</a></code></pre></div>
<p>Bipartite algorithms applied on example dataset.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># With fastgreedy</span></a>
<a class="sourceLine" id="cb18-2" title="2">bip &lt;-<span class="st"> </span><span class="kw"><a href="../reference/algo_bipartite.html">algo_bipartite</a></span>(<span class="dt">dat =</span> sp_mat, <span class="dt">algo =</span> <span class="st">"greedy"</span>, <span class="dt">weight =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co"># With Beckett algorithm</span></a>
<a class="sourceLine" id="cb18-5" title="5">bip2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/algo_bipartite.html">algo_bipartite</a></span>(<span class="dt">dat =</span> sp_mat, <span class="dt">algo =</span> <span class="st">"LPAwb"</span>, <span class="dt">weight =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb18-6" title="6"></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co"># Only sites</span></a>
<a class="sourceLine" id="cb18-8" title="8">bip_site &lt;-<span class="st"> </span>bip <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cat <span class="op">==</span><span class="st"> "site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">site =</span> node) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(site, module)</a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13">bip_site2 &lt;-<span class="st"> </span>bip2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cat <span class="op">==</span><span class="st"> "site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">site =</span> node) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(site, module)</a></code></pre></div>
<p>Cz computation on bipartite results.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">bip_cz &lt;-<span class="st"> </span>bip[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"node"</span>, <span class="st">"module"</span>, <span class="st">"cat"</span>)]</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(bip_cz) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"node"</span>, <span class="st">"mod"</span>, <span class="st">"cat"</span>)</a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4">link_cz &lt;-<span class="st"> </span>sp_df[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"sp"</span>)] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">  </span><span class="kw">left_join</span>(bip_cz[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(bip_cz<span class="op">$</span>cat <span class="op">==</span><span class="st"> "site"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"node"</span>, <span class="st">"mod"</span>)],</a>
<a class="sourceLine" id="cb19-6" title="6">            <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span> =<span class="st"> "node"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">mod_site =</span> mod) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="st">  </span><span class="kw">left_join</span>(bip_cz[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(bip_cz<span class="op">$</span>cat <span class="op">==</span><span class="st"> "sp"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"node"</span>, <span class="st">"mod"</span>)],</a>
<a class="sourceLine" id="cb19-9" title="9">            <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sp"</span> =<span class="st"> "node"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">mod_sp =</span> mod)</a>
<a class="sourceLine" id="cb19-11" title="11"></a>
<a class="sourceLine" id="cb19-12" title="12">cz_bip &lt;-<span class="st"> </span><span class="kw">cz</span>(<span class="dt">link_dat =</span> link_cz, <span class="dt">dat =</span> bip_cz, <span class="dt">ab =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb19-13" title="13"></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(cz_bip[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>##      node mod  cat    C n_link_mod mean_link_mod sd_link_mod          z
## 1 site101   1 site 0.88         10      17.95918    23.73215 -0.3353756
## 2 site103   1 site 0.88         10      17.95918    23.73215 -0.3353756
## 3 site108   1 site 0.88         10      17.95918    23.73215 -0.3353756
## 4 site121   1 site 0.88         10      17.95918    23.73215 -0.3353756
## 5 site123   1 site 0.88         10      17.95918    23.73215 -0.3353756
## 6 site124   1 site 0.88         10      17.95918    23.73215 -0.3353756</code></pre>
<p>Projection on a map.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb21-2" title="2">  <span class="co"># Plot of environmental values</span></a>
<a class="sourceLine" id="cb21-3" title="3">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> env, <span class="dt">color =</span> env),</a>
<a class="sourceLine" id="cb21-7" title="7">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">    </span><span class="kw">scale_color_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Environmental variable"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,<span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb21-13" title="13">  </a>
<a class="sourceLine" id="cb21-14" title="14">  <span class="co"># Plot of OSLOM bioregions</span></a>
<a class="sourceLine" id="cb21-15" title="15">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="st">    </span><span class="kw">left_join</span>(oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-18" title="18"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(bioregion), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(bioregion)),</a>
<a class="sourceLine" id="cb21-20" title="20">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-21" title="21"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-22" title="22"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-23" title="23"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-24" title="24"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"OSLOM bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-25" title="25"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,</a>
<a class="sourceLine" id="cb21-26" title="26">                                          <span class="dt">colour =</span> <span class="st">"black"</span>)),</a>
<a class="sourceLine" id="cb21-27" title="27">  </a>
<a class="sourceLine" id="cb21-28" title="28">  <span class="co"># Plot of Ward bioregions</span></a>
<a class="sourceLine" id="cb21-29" title="29">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-30" title="30"><span class="st">    </span><span class="kw">left_join</span>(ward_res, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-31" title="31"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-32" title="32"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-33" title="33"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(cluster), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(cluster)),</a>
<a class="sourceLine" id="cb21-34" title="34">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-35" title="35"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-36" title="36"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-37" title="37"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-38" title="38"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Ward bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-39" title="39"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,<span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb21-40" title="40">  </a>
<a class="sourceLine" id="cb21-41" title="41">  <span class="co"># Plot of fastgreedy bioregions</span></a>
<a class="sourceLine" id="cb21-42" title="42">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-43" title="43"><span class="st">    </span><span class="kw">left_join</span>(bip_site, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-44" title="44"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-45" title="45"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-46" title="46"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb21-47" title="47">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-48" title="48"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-49" title="49"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-50" title="50"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-51" title="51"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Bipartite greedy bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-52" title="52"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,<span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb21-53" title="53">  </a>
<a class="sourceLine" id="cb21-54" title="54">  <span class="co"># Plot of LPAwb bioregions</span></a>
<a class="sourceLine" id="cb21-55" title="55">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-56" title="56"><span class="st">    </span><span class="kw">left_join</span>(bip_site2, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-57" title="57"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-58" title="58"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-59" title="59"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb21-60" title="60">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-61" title="61"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-62" title="62"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-63" title="63"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-64" title="64"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"LPAwb+ greedy bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-65" title="65"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,<span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb21-66" title="66">  <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/map_virtual_dataset-1.png" width="1152"></p>
<p>All these functions can be called with the wrap-up <code><a href="../reference/all_maps.html">all_maps()</a></code> function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="../reference/all_maps.html">all_maps</a></span>()</a></code></pre></div>
<p>Another dataset is available within <em>Bioregionalization</em> and all the above analyses can be run in an identical fashion.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># Import Mediterranean dataset</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"medit"</span>)</a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="co"># Plot of Mediterranean area</span></a>
<a class="sourceLine" id="cb23-5" title="5">medit[[<span class="dv">2</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="st">  </span><span class="kw">geom_sf</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"Mediterranean area, resolution 40x40km"</span><span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb23-9" title="9">       <span class="dt">x =</span> <span class="st">"Longitude"</span>, <span class="dt">y =</span> <span class="st">"Latitude"</span>)</a>
<a class="sourceLine" id="cb23-10" title="10"></a>
<a class="sourceLine" id="cb23-11" title="11">sp_df &lt;-<span class="st"> </span>medit[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">site =</span> id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(site),</a>
<a class="sourceLine" id="cb23-14" title="14">         <span class="dt">sp =</span> <span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(sp))</a>
<a class="sourceLine" id="cb23-15" title="15"></a>
<a class="sourceLine" id="cb23-16" title="16"><span class="co"># Random vector of abundances assigned for weighted networks</span></a>
<a class="sourceLine" id="cb23-17" title="17">sp_df<span class="op">$</span>ab &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dt">n =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(sp_df), <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb23-18" title="18"></a>
<a class="sourceLine" id="cb23-19" title="19"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(medit[[<span class="dv">2</span>]]) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"geometry"</span>)</a>
<a class="sourceLine" id="cb23-20" title="20">medit[[<span class="dv">2</span>]]<span class="op">$</span>site &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(medit[[<span class="dv">2</span>]]<span class="op">$</span>site)</a>
<a class="sourceLine" id="cb23-21" title="21"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(medit[[<span class="dv">2</span>]]) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"geometry"</span>)</a></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Pierre Denelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
